/**
 * jquery-datatable-simply-builder - Dynamically construct tables
 * @date Fri Jun 13 2025 14:29:41 GMT+0800 (CST)
 * @version v1.0.0
 * @author jozhliu@jozhcloud.com
 */
!function(t){t.fn.tableBuilder=function(a){let l=t.extend(!0,{},{title:"",thSet:[],dataSet:[],parameters:{page:1,pageSize:10,sort:{}},loadingPageDataFunName:"",serialColText:"#"},a),i=function a(l){let{title:i,thSet:s,dataSet:o,parameters:n,serialColText:r}=l,d=t("<div>");e(i)||t('<div class="table-head">').text(i).appendTo(d);let c=t('<table class="table">').attr("width","100%").appendTo(d);e(s)&&!e(o)&&Object.entries(o[0]).forEach(([t,e])=>{s.push({text:t,field:t,resizable:e.length>500})});let p=t("<thead>").appendTo(c),h=t("<tr>").appendTo(p);s.unshift({width:50,text:r}),s.forEach(e=>{let a=t(`<th${e.resizable?' class="resizable"':""}${e.width?' style="width: '+e.width+'px"':""}${e.field?" data-field="+e.field:""}>`).text(e.text);if(e.sortable&&e.field){let l=n.sort[e.field]||"";a.addClass("csr-pointer").attr("data-sort",l).append(`<span class="sort-icon"><svg viewBox="0 0 100 100" class="sort-indicator"><polygon points="50,20 90,70 10,70" class="sort-asc"/><polygon points="50,80 90,30 10,30" class="sort-desc"/></svg></span>`)}e.className&&a.addClass(e.className),a.appendTo(h)});let f=t("<tbody>").appendTo(c);if(e(o)){let $=e(s)?1:s.length;t(`<tr class="no-data"><td colspan="${$}">`).text("No Data").appendTo(f)}else{let g=(n.page-1)*n.pageSize+1;o.forEach((a,l)=>{let i=t("<tr>").addClass(l%2==0?"even-row":"odd-row").appendTo(f);s.forEach((l,s)=>{if(0===s)t("<td>").text(g).appendTo(i);else if(l.field){let o=t("<td>").text(a[l.field]);l.copiable&&a[l.field]&&"string"==typeof a[l.field]&&o.addClass("copiable").append(`<span class="copy-icon"><svg viewBox="0 0 24 24" class="copy-indicator"><rect x="7" y="7" width="12" height="12" rx="1" stroke="currentColor" stroke-width="2"/><path d="M5 15H4C3.44772 15 3 14.5523 3 14V4C3 3.44772 3.44772 3 4 3H14C14.5523 3 15 3.44772 15 4V5" stroke="currentColor" stroke-width="2"/></svg></span>`),l.align&&o.css("text-align",l.align||"center"),o.appendTo(i)}else l.options&&t("<td>").html(function a(l,i){let s="";if(e(l))return s;let o=["br","hr","img","input"];return l.forEach(a=>{if(e(a.label))s+=a.text||"Configuration error in 'thSet'ï¼š"+JSON.stringify(a);else{let l="";l+=`<${a.label}`,e(a.attr)||t.each(a.attr,function(t,e){e=e.replace(/"/g,"&quot;");let a=e.match(/__(\w+)__/);if(a){let s=a[1],o=RegExp("__"+s+"__");e=e.replace(o,i[s])}l+=` ${t}="${e}"`}),-1!==t.inArray(a.label,o)?l+=" />":l+=`>${a.text}</${a.label}>`,s+=l}}),s}(l.options,a)).appendTo(i)}),g++})}return d.html()}(l);return this.each(function(){t(this).html(i),function a(l){t(document).off("click",".copiable span").on("click",".copiable span",function(){let e=t(this).parent().text().trim(),a=document.createElement("textarea");a.value=e,document.body.appendChild(a),a.select();let l=document.execCommand("copy");document.body.removeChild(a),l&&(t(".table td.copiable .copy-indicator").each(function(){t(this).removeClass("copied")}),t(this).find("svg").addClass("copied"),alert("Copied"))});let i=l.parameters,s=l.loadingPageDataFunName;t(document).off("click","th[data-sort]").on("click","th[data-sort]",function(){let a=t(this).data("field")||"",l=t(this).data("sort")||"";l="desc"===l?"asc":"asc"===l?"":"desc",t(this).data("sort",l),i.sort[a]=l,e(s)||e(window[s])||window[s](i)})}(l)})};function e(t){return null==t||"string"==typeof t&&""===t.trim()||Array.isArray(t)&&0===t.length||"object"==typeof t&&0===Object.keys(t).length}}(jQuery);